<!DOCTYPE html>
<html lang="">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title></title>
	</head>

	<body>
		<h2>Personliste</h2>
		<article id="personliste"></article>
		<script> //find DOM elementer
			let container = document.querySelector("#personliste");
			let personer;
			//hent json
			async function getJson() {
				let liste = await fetch("personer.json");
				personer = await liste.json();
				//console.log(personer);
				visPersoner();
			}

			function visPersoner() {
				personer.forEach((person,i) => {
					//opret element og indsæt i DOM
					const clon = "<section class='person'><h3 data-navn>"+person.fornavn+" "+person.efternavn+"</h3><p>email: "+person.email+"</p><p data-linktosingle>Se single</p></section>";
					container.insertAdjacentHTML('beforeend', clon);

					//jeg bruger email som id, da den er unik
					const id = person.email;
					//når der klikkes på en person gemmes denne i sessionStorage
					container.querySelectorAll(".person")[i].addEventListener("click", () => {
						sessionStorage.setItem("single", JSON.stringify(person));
						//visSingle();
						//id bliver sendt med som urlvariabel til singleside
						location.href = "single2.html?id="+id;
						console.log(id);
					});
				});
			}

			/*function visSingle() {
     let mySingle = sessionStorage.getItem("single");
     let info = JSON.parse(mySingle);
     console.log(info);
 }*/
			//læs script når DOM er hentet
			document.addEventListener("DOMContentLoaded", getJson);
		</script>
	</body>
</html>
